plugin: networktocode.nautobot.inventory
api_endpoint: <<NAUTOBOT_API_URL>>
token: <NAUTOBOT_API_TOKEN>
validate_certs: true

# Query devices and virtual machines
query:
  devices:
    name:
    primary_ip4:
      host:
    platform:
      name:
      napalm_driver:
    device_role:
      name:
      slug:
    site:
      name:
      slug:
    location:
      name:
    tenant:
      name:
    tags:
      name:
    status:
      value:
    serial:
  virtual_machines:
    name:
    primary_ip4:
      host:
    platform:
      name:
    tenant:
      name:
    tags:
      name:

# Group devices dynamically
group_by:
  - device_role.slug
  - site.slug
  - platform.name
  - status.value
  - tags.name

# Set ansible_host to primary IP
compose:
  ansible_host: primary_ip4.host | default(primary_ip6.host)
  ansible_network_os: platform.napalm_driver

# Additional filtering (optional)
# query_filters:
#   - role: network-switch
#   - status: active
